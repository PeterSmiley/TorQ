
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../graphics/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.4">
    
    
      
        <title>Processes - TorQ</title>
      
    
    
      <script src="../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-769c285a91.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02c2a4388f.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href=".." title="TorQ" class="md-logo md-header-nav__button">
            <img src="../graphics/TorQ-logo.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Processes
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/AquaQAnalytics/TorQ" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../graphics/TorQ-logo.png">
      </i>
    
    TorQ
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/AquaQAnalytics/TorQ" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Overview/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gettingstarted/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../utilities/" title="Utilities" class="md-nav__link">
      Utilities
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../handlers/" title="Handlers" class="md-nav__link">
      Handlers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../conn/" title="Connection Management" class="md-nav__link">
      Connection Management
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Processes
      </label>
    
    <a href="./" title="Processes" class="md-nav__link md-nav__link--active">
      Processes
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#discovery-service" title="Discovery Service" class="md-nav__link">
    Discovery Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operation" title="Operation" class="md-nav__link">
    Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-processes" title="Available Processes" class="md-nav__link">
    Available Processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gateway" title="Gateway" class="md-nav__link">
    Gateway
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asynchronous-behaviour" title="Asynchronous Behaviour" class="md-nav__link">
    Asynchronous Behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-behaviour" title="Synchronous Behaviour" class="md-nav__link">
    Synchronous Behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-discovery" title="Process Discovery" class="md-nav__link">
    Process Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" title="Error Handling" class="md-nav__link">
    Error Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-calls" title="Client Calls" class="md-nav__link">
    Client Calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-kdb-clients" title="Non kdb+ Clients" class="md-nav__link">
    Non kdb+ Clients
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tickerplant" title="Tickerplant" class="md-nav__link">
    Tickerplant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-time-database-rdb" title="Real Time Database (RDB)" class="md-nav__link">
    Real Time Database (RDB)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-database-wdb" title="Write Database (WDB)" class="md-nav__link">
    Write Database (WDB)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tickerplant-log-replay" title="Tickerplant Log Replay" class="md-nav__link">
    Tickerplant Log Replay
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#housekeeping" title="Housekeeping" class="md-nav__link">
    Housekeeping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-alerter" title="File Alerter" class="md-nav__link">
    File Alerter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reporter" title="Reporter" class="md-nav__link">
    Reporter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-configuration" title="Report Configuration" class="md-nav__link">
    Report Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-handlers" title="Result Handlers" class="md-nav__link">
    Result Handlers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-process-tracking" title="Report Process Tracking" class="md-nav__link">
    Report Process Tracking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribing-for-results" title="Subscribing for Results" class="md-nav__link">
    Subscribing for Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-reports" title="Example reports" class="md-nav__link">
    Example reports
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitor" title="Monitor" class="md-nav__link">
    Monitor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#html5-front-end" title="HTML5 front end" class="md-nav__link">
    HTML5 front end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compression" title="Compression" class="md-nav__link">
    Compression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kill" title="Kill" class="md-nav__link">
    Kill
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chained-tickerplant" title="Chained Tickerplant" class="md-nav__link">
    Chained Tickerplant
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../visualisation/" title="Visualisation" class="md-nav__link">
      Visualisation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../blog/" title="TorQ Blog Posts" class="md-nav__link">
      TorQ Blog Posts
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#discovery-service" title="Discovery Service" class="md-nav__link">
    Discovery Service
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operation" title="Operation" class="md-nav__link">
    Operation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-processes" title="Available Processes" class="md-nav__link">
    Available Processes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gateway" title="Gateway" class="md-nav__link">
    Gateway
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#asynchronous-behaviour" title="Asynchronous Behaviour" class="md-nav__link">
    Asynchronous Behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synchronous-behaviour" title="Synchronous Behaviour" class="md-nav__link">
    Synchronous Behaviour
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-discovery" title="Process Discovery" class="md-nav__link">
    Process Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" title="Error Handling" class="md-nav__link">
    Error Handling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-calls" title="Client Calls" class="md-nav__link">
    Client Calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-kdb-clients" title="Non kdb+ Clients" class="md-nav__link">
    Non kdb+ Clients
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tickerplant" title="Tickerplant" class="md-nav__link">
    Tickerplant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-time-database-rdb" title="Real Time Database (RDB)" class="md-nav__link">
    Real Time Database (RDB)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-database-wdb" title="Write Database (WDB)" class="md-nav__link">
    Write Database (WDB)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tickerplant-log-replay" title="Tickerplant Log Replay" class="md-nav__link">
    Tickerplant Log Replay
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#housekeeping" title="Housekeeping" class="md-nav__link">
    Housekeeping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-alerter" title="File Alerter" class="md-nav__link">
    File Alerter
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reporter" title="Reporter" class="md-nav__link">
    Reporter
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" title="Overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-configuration" title="Report Configuration" class="md-nav__link">
    Report Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result-handlers" title="Result Handlers" class="md-nav__link">
    Result Handlers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-process-tracking" title="Report Process Tracking" class="md-nav__link">
    Report Process Tracking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribing-for-results" title="Subscribing for Results" class="md-nav__link">
    Subscribing for Results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-reports" title="Example reports" class="md-nav__link">
    Example reports
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitor" title="Monitor" class="md-nav__link">
    Monitor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#html5-front-end" title="HTML5 front end" class="md-nav__link">
    HTML5 front end
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compression" title="Compression" class="md-nav__link">
    Compression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kill" title="Kill" class="md-nav__link">
    Kill
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chained-tickerplant" title="Chained Tickerplant" class="md-nav__link">
    Chained Tickerplant
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/AquaQAnalytics/TorQ/edit/master/docs/Processes.md" title="Edit this page" class="md-icon md-content__icon">edit</a>
                
                
                <p><a name="Processes"></a></p>
<h1 id="processes">Processes</h1>
<p>A set of processes is included. These processes build upon AquaQ TorQ,
providing specific functionality. All the process scripts are contained
in $KDBCODE/processes. All processes should have an entry in
$KDBCONFIG/process.csv. All processes can have any type and name,
except for discovery services which must have a process type of
“discovery”. An example process.csv is:</p>
<pre><code>aquaq$ cat config/process.csv
host,port,proctype,procname
aquaq,9998,rdb,rdb_europe_1
aquaq,9997,hdb,rdb_europe_1aquaq,9999,hdb,hdb1
aquaq,9996,discovery,discovery1
aquaq,9995,discovery,discovery2
aquaq,8000,gateway,gateway1
aquaq,5010,tickerplant,tickerplant1
aquaq,5011,rdb,rdb1
aquaq,5012,hdb,hdb1
aquaq,5013,hdb,hdb2
aquaq,9990,tickerlogreplay,tpreplay1
aquaq,20000,kill,killhdbs
aquaq,20001,monitor,monitor1
aquaq,20002,housekeeping,hk1
</code></pre>
<p><a name="disc"></a></p>
<h2 id="discovery-service">Discovery Service</h2>
<h3 id="overview">Overview</h3>
<p>Processes use the discovery service to register their own availability,
find other processes (by process type) and subscribe to receive updates
for new process availability (by process type). The discovery service
does not manage connections- it simply returns tables of registered
processes, irrespective of their current availability. It is up to each
individual process to manage its own connections.</p>
<p>The discovery service uses the process.csv file to make connections to
processes on start up. After start up it is up to each individual
process to attempt connections and register with the discovery service.
This is done automatically, depending on the configuration parameters.
Multiple discovery services can be run in which case each process will
try to register and retrieve process details from each discovery process
it finds in its process.csv file. Discovery services do not replicate
between themselves. A discovery process must have its process type
listed as discovery.</p>
<p>To run the discovery service, use a start line such as:</p>
<pre><code>aquaq $ q torq.q -load code/processes/discovery.q -p 9995
</code></pre>
<p>Modify the configuration as required.</p>
<h3 id="operation">Operation</h3>
<ol>
<li>
<p>Processes register with the discovery service.</p>
<p><img alt="Discovery service
registration" src="../graphics/discovery1.png" /></p>
</li>
<li>
<p>Processes use the discovery service to locate other processes.</p>
<p><img alt="Process location" src="../graphics/discovery2.png" /></p>
</li>
<li>
<p>When new services register, any processes which have registered an
     interest in that process type are notified.</p>
<p><img alt="Notification" src="../graphics/discovery3.png" /></p>
</li>
</ol>
<h3 id="available-processes">Available Processes</h3>
<p>The list of available processes can be found in the .servers.SERVERS
table.</p>
<pre><code>q).servers.SERVERS                                                                                                                                                                                                                                                            
procname     proctype        hpup            w  hits startp                        lastp                         endp attributes                                                                   
-------------------------------------------------------------------------------------
discovery1   discovery       :aquaq:9995     0                                  2014.01.22D17:00:40.947470000      ()!()                                                                        
discovery2   discovery       :aquaq:9996     0                                  2014.01.22D17:00:40.947517000      ()!()                                                                        
hdb2         hdb             :aquaq:5013     0                                  2014.01.22D17:00:40.947602000      ()!()                                                                        
killtick     kill            :aquaq:20000    0                                  2014.01.22D17:00:40.947602000      ()!()                                                                        
tpreplay1    tickerlogreplay :aquaq:20002    0                                  2014.01.22D17:00:40.947602000      ()!()                                                                        
tickerplant1 tickerplant     :aquaq:5010  6  0    2014.01.22D17:00:40.967699000 2014.01.22D17:00:40.967698000      ()!()                                                                        
monitor1     monitor         :aquaq:20001 9  0    2014.01.22D17:00:40.971344000 2014.01.22D17:00:40.971344000      ()!()                                                                        
rdb1         rdb             :aquaq:5011  7  0    2014.01.22D17:06:13.032883000 2014.01.22D17:06:13.032883000      `date`tables!(,2014.01.22;`fxquotes`heartbeat`logmsg`quotes`trades)          
hdb3         hdb             :aquaq:5012  8  0    2014.01.22D17:06:18.647349000 2014.01.22D17:06:18.647349000      `date`tables!(2014.01.13 2014.01.14;`fxquotes`heartbeat`logmsg`quotes`trades)
gateway1     gateway         :aquaq:5020  10 0    2014.01.22D17:06:32.152836000 2014.01.22D17:06:32.152836000      ()!()
</code></pre>
<p><a name="gate"></a></p>
<h2 id="gateway">Gateway</h2>
<p>A synchronous and asynchronous gateway is provided. The gateway can be
used for load balancing and/or to join the results of queries across
heterogeneous servers (e.g. an RDB and HDB). Ideally the gateway should
only be used with asynchronous calls. Synchronous calls cause the
gateway to block so limits the gateway to serving one query at a time
(although if querying across multiple backend servers the backend
queries will be run in parallel). When using asynchronous calls the
client can either block and wait for the result (deferred synchronous)
or post a call back function which the gateway will call back to the
client with. With both asynchronous and synchronous queries the backend
servers to execute queries against are selected using process type. The
gateway API can be seen by querying .api.p“.gw.*” within a gateway
process.</p>
<p><img alt="Gateway behaviour" src="../graphics/async.png" /></p>
<h3 id="asynchronous-behaviour">Asynchronous Behaviour</h3>
<p>Asynchronous queries allow much greater flexibility. They allow multiple
queries to be serviced at once, prioritisation, and queries to be timed
out. When an asynchronous query is received the following happens:</p>
<ul>
<li>
<p>the query is placed in a queue;</p>
</li>
<li>
<p>the list of available servers is retrieved;</p>
</li>
<li>
<p>the queue is prioritised, so those queries with higher priority are
      serviced first;</p>
</li>
<li>
<p>queries are sent to back end servers as they become available. Once
      the backend server returns its result, it is given another query;</p>
</li>
<li>
<p>when all the partial results from the query are returned the results
      are aggregated and returned to the client. They are either returned
      directly, or wrapped in a callback and posted back asynchronously to
      the client.</p>
</li>
</ul>
<p>The two main customisable features of the gateway are the selection of
available servers (.gw.availableservers) and the queue prioritisation
(.gw.getnextqueryid). With default configuration, the available servers
are those servers which are not currently servicing a query from the
gateway, and the queue priority is a simple FIFO queue. The available
servers could be extended to handle process attributes, such as the
available datasets or the location of the process, and the queue
prioritisation could be modified to anything required e.g. based on the
query itself, the username, host of the client etc.</p>
<p>An asynchronous query can be timed out using a timeout defined by the
client. The gateway will periodically check if any client queries have
not completed in the alotted time, and return a timeout error to the
client. If the query is already running on any backend servers then they
cannot be timed out other than by using the standard -T flag.</p>
<h3 id="synchronous-behaviour">Synchronous Behaviour</h3>
<p>When using synchronous queries the gateway can only handle one query at
a time and cannot timeout queries other than with the standard -T flag.
All synchronous queries will be immediately dispatched to the back end
processes. They will be dispatched using an asyhcnronous call, allowing
them to run in parallel rather than serially. When the results are
received they are aggregated and returned to the client.</p>
<h3 id="process-discovery">Process Discovery</h3>
<p>The gateway uses the discovery service to locate processes to query
across. The discovery service will notify the gateway when new processes
become available and the gateway will automatically connect and start
using them. The gateway can also use the static information in
process.csv, but this limits the gateway to a predefined list of
processes rather than allowing new services to come online as demand
requires.</p>
<h3 id="error-handling">Error Handling</h3>
<p>When synchronous calls are used, q errors are returned to clients as
they are encountered. When using asynchronous calls there is no way to
return actual errors and appropriately prefixed strings must be used
instead. It is up to the client to check the type of the received result
and if it is a string then whether it contains the error prefix. The
error prefix can be changed, but the default is “error: ”. Errors will
be returned when:</p>
<ul>
<li>
<p>the client requests a query against a server type which the gateway
    does not currently have any active instances of (this error is
    returned immediately);</p>
</li>
<li>
<p>the query is timed out;</p>
</li>
<li>
<p>a back end server returns an error;</p>
</li>
<li>
<p>a back end server fails;</p>
</li>
<li>
<p>the join function fails.</p>
</li>
</ul>
<p>If postback functions are used, the error string will be posted back
within the postback function (i.e. it will be packed the same way as a
valid result).</p>
<h3 id="client-calls">Client Calls</h3>
<p>There are four main client calls. The .gw.sync* methods should only be
invoked synchronously, and the .gw.async* methods should only be
invoked asynchronously. Each of these are documented more extensively in
the gateway api. Use .api.p“.gw.*” for more details.</p>
<table>
<thead>
<tr>
<th align="center">Function</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">.gw.syncexec[query; servertypes]</td>
<td align="center">Execute the specified query synchronously against the required list of servers. If more than one server, the results will be razed.</td>
</tr>
<tr>
<td align="center">.gw.syncexecj[query; servertypes; joinfunction]</td>
<td align="center">Execute the specified query against the required list of servers. Use the specified join function to aggregate the results.</td>
</tr>
<tr>
<td align="center">.gw.asyncexec[query; servertypes]</td>
<td align="center">Execute the specified query against the required list of servers. If more than one server, the results will be razed. The client must block and wait for the results.</td>
</tr>
<tr>
<td align="center">.gw.asyncexecjpt[query; servertypes; joinfunction; postback; timeout]</td>
<td align="center">Execute the specified query against the required list of servers. Use the specified join function to aggregate the results. If the postback function is not set, the client must block and wait for the results. If it is set, the result will be wrapped in the specified postback function and returned asynchronously to the client. The query will be timed out if the timeout value is exceeded.</td>
</tr>
</tbody>
</table>
<p>For the purposes of demonstration, assume that the queries must be run
across an RDB and HDB process, and the gateway has one RDB and two HDB
processes available to it.</p>
<pre><code>q).gw.servers                                                                                                                                                                                                                                                                 
handle| servertype inuse active querycount lastquery                     usage                attributes                   
------| --------------------------------------------------------------------
7     | rdb        0     1      17         2014.01.07D17:05:03.113927000 0D00:00:52.149069000 `datacentre`country!`essex`uk
8     | hdb        0     1      17         2014.01.07D17:05:03.113927000 0D00:01:26.143564000 `datacentre`country!`essex`uk
9     | hdb        0     1      2          2014.01.07D16:47:33.615538000 0D00:00:08.019862000 `datacentre`country!`essex`uk
12    | rdb        0     1      2          2014.01.07D16:47:33.615538000 0D00:00:04.018349000 `datacentre`country!`essex`uk
</code></pre>
<p>Both the RDB and HDB processes have a function f and table t defined. f
will run for 2 seconds longer on the HDB processes then it will the RDB.</p>
<pre><code>q)f                                                                                                                                                                                                                                                                           
{system"sleep ",string x+$[`hdb=.proc.proctype;2;0]; t}
q)t                                                                                                                                                                                                                                                                           
a   
----
5013
5014
5015
5016
5017
</code></pre>
<p>Run the gateway. The main parameter which should be set is the
.servers.CONNECTIONS parameter, which dictates the process types the
gateway queries across. Also, we need to explicitly allow sync calls. We
can do this from the config or from the command line.</p>
<pre><code>q torq.q -load code/processes/gateway.q -p 8000 -.gw.synccallsallowed 1 -.servers.CONNECTIONS hdb rdb
</code></pre>
<p>Start a client and connect to the gateway. Start with a sync query. The
HDB query should take 4 seconds and the RDB query should take 2 seconds.
If the queries run in parallel, the total query time should be 4
seconds.</p>
<pre><code>q)h:hopen 8000                                                                                                                                                                                                                                                                
q)h(`.gw.syncexec;(`f;2);`hdb`rdb)                                                                                                                                                                                                                                            
a   
----
5014
5015
5016
5017
5018
5012
5013
5014
5015
5016
q)\t h(`.gw.syncexec;(`f;2);`hdb`rdb)                                                                                                                                                                                                                                         
4009
</code></pre>
<p>If a query is done for a server type which is not registered, an error
is returned:</p>
<pre><code>q)\t h(`.gw.syncexec;(`f;2);`hdb`rdb`other)                                                                                                                                                                                                                                   
`not all of the requested server types are available; missing other
</code></pre>
<p>Custom join functions can be specified:</p>
<pre><code>q)h(`.gw.syncexecj;(`f;2);`hdb`rdb;{sum{select count i by a from x} each x})                                                                                                                                                                                                  
a   | x
----| -
5014| 2
5015| 2
5016| 2
5017| 1
5018| 1
5012| 1
5013| 1
</code></pre>
<p>Custom joins can fail with appropriate errors:</p>
<pre><code>q)h(`.gw.syncexecj;(`f;2);`hdb`rdb;{sum{select count i by b from x} each x})                                                                                                                                                                                                  
`failed to apply supplied join function to results: b
</code></pre>
<p>Asynchronous queries must be sent in async and blocked:</p>
<pre><code>q)(neg h)(`.gw.asyncexec;(`f;2);`hdb`rdb); r:h(::)                                                                                                                                                                                                                          
    /- This white space is from pressing return
    /- the client is blocked and unresponsive

q)q)q)                                                                                                                                                                                                                                                                        
q)                                                                                                                                                                                                                                                                            
q)r                                                                                                                                                                                                                                                                           
a   
----
5014
5015
5016
5017
5018
5012
5013
5014
5015
5016
q)
</code></pre>
<p>We can send multiple async queries at once. Given the gateway has two
RDBs and two HDBs avaialble to it, it should be possible to service two
of these queries at the same time.</p>
<pre><code>q)h:hopen each 8000 8000                                                                                                                                                                                                                                                      
q)\t (neg h)@\:(`.gw.asyncexec;(`f;2);`hdb`rdb); (neg h)@\:(::); r:h@\:(::)
4012
q)r                                                                                                                                                                                                                                                                           
+(,`a)!,5014 5015 5016 5017 5018 5012 5013 5014 5015 5016
+(,`a)!,5013 5014 5015 5016 5017 9999 10000 10001 10002 10003
</code></pre>
<p>Alternatively async queries can specify a postback so the client does
not have to block and wait for the result. The postback function must
take two parameters- the first is the function that was sent up, the
second is the results. The postback can either be a lambda, or the name
of a function.</p>
<pre><code>q)h:hopen 8000                                                                                                                                                                                                                                                                
q)handleresults:{-1(string .z.z)," got results"; -3!x; show y}                                                                                                                                                                                                                
q)(neg h)(`.gw.asyncexecjpt;(`f;2);`hdb`rdb;raze;handleresults;0Wn)                                                                                                                                                                                                           
q)
q)  /- These q prompts are from pressing enter
q)  /- The q client is not blocked, unlike the previous example
q)
q)2014.01.07T16:53:42.481 got results
a   
----
5014
5015
5016
5017
5018
5012
5013
5014
5015
5016

/- Can also use a named function rather than a lambda
q)(neg h)(`.gw.asyncexecjpt;(`f;2);`hdb`rdb;raze;`handleresults;0Wn)
q)
q)              
q)2014.01.07T16:55:12.235 got results
a   
----
5014
5015
5016
5017
5018
5012
5013
5014
5015
5016
</code></pre>
<p>Asynchronous queries can also be timed out. This query will run for 22
seconds, but should be timed out after 5 seconds. There is a tolerance
of +5 seconds on the timeout value, as that is how often the query list
is checked. This can be reduced as required.</p>
<pre><code>q)(neg h)(`.gw.asyncexecjpt;(`f;20);`hdb`rdb;raze;();0D00:00:05); r:h(::)

q)q)q)r                                                                                                                                                                                                                                                                       
"error: query has exceeded specified timeout value"
q)\t (neg h)(`.gw.asyncexecjpt;(`f;20);`hdb`rdb;raze;();0D00:00:05); r:h(::)                                                                                                                                                                                                  
6550
</code></pre>
<h3 id="non-kdb-clients">Non kdb+ Clients</h3>
<p>All the examples in the previous section are from clients written in q.
However it should be possible to do most of the above from non kdb+
clients. The officially supported APIs for Java, C# and C allow the
asynchronous methods above. For example, we can modify the try block in
the main function of the <a href="http://code.kx.com/wiki/Cookbook/InterfacingWithJava">Java Grid
Viewer</a>:</p>
<pre><code>import java.awt.BorderLayout;
import java.awt.Color;
import java.io.IOException;
import java.lang.reflect.Array;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.AbstractTableModel;
import kx.c;

public class Main {
    public static class KxTableModel extends AbstractTableModel {
        private c.Flip flip;
        public void setFlip(c.Flip data) {
            this.flip = data;
        }

        public int getRowCount() {
            return Array.getLength(flip.y[0]);
        }

        public int getColumnCount() {
            return flip.y.length;
        }

        public Object getValueAt(int rowIndex, int columnIndex) {
            return c.at(flip.y[columnIndex], rowIndex);
        }

        public String getColumnName(int columnIndex) {
            return flip.x[columnIndex];
        }
    };

    public static void main(String[] args) {
        KxTableModel model = new KxTableModel();
        c c = null;
        try {
            c = new c("localhost", 8000,"username:password");
            // Create the query to send
        String query=".gw.asyncexec[(`f;2);`hdb`rdb]";
            // Send the query 
        c.ks(query);
            // Block on the socket and wait for the result
        model.setFlip((c.Flip) c.k());
        } catch (Exception ex) {
            Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
        } finally {
            if (c != null) {try{c.close();} catch (IOException ex) {}
          }
        }
        JTable table = new JTable(model);
        table.setGridColor(Color.BLACK);
        String title = "kdb+ Example - "+model.getRowCount()+" Rows";
        JFrame frame = new JFrame(title);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().add(new JScrollPane(table), BorderLayout.CENTER);
        frame.setSize(300, 300);
        frame.setVisible(true);
    }
}
</code></pre>
<p>Some of the unofficially supported APIs may only allow synchronous calls
to be made.</p>
<p><a name="tickerplant"></a></p>
<h2 id="tickerplant">Tickerplant</h2>
<p>The tickerplant is a modified version of the standard kdb+tick tickerplant.
The modifications from the standard tick.q include:</p>
<ul>
<li>
<p>Applies timestamps as timestamp rather than timespan;</p>
</li>
<li>
<p>Tracks per table record counts in .u.icounts dictionary for faster recovery
    of real time subscribers;</p>
</li>
<li>
<p>Allows configuration of timezones for timestamping data and performing
    end of day rollover (see <a href="../utilities/#eodtimeq">eodtime.q</a>);</p>
</li>
</ul>
<p>The tickerplant log file will be written to hdb/database.</p>
<p><a name="rdb"></a></p>
<h2 id="real-time-database-rdb">Real Time Database (RDB)</h2>
<p>The Real Time Database is a modified version of r.q found in kdb+tick.
The modifications from the standard r.q include:</p>
<ul>
<li>
<p>Tickerplant (data source) and HDB location derived from processes
    defined by the discovery service or from config file;</p>
</li>
<li>
<p>Automatic re-connection and resubscription to tickerplant;</p>
</li>
<li>
<p>List of tables to subscribe to supplied as configuration setting;</p>
</li>
<li>
<p>More pre-built flexibility in end-of-day;</p>
</li>
<li>
<p>More verbose end-of-day logging;</p>
</li>
<li>
<p>Reload multiple authenticated HDBs after end-of-day;</p>
</li>
<li>
<p>End-of-day save down manipulation code is shared between RDB, WDB
      and tickerplant log replay</p>
</li>
</ul>
<p>See the top of the file for more information.</p>
<p><a name="wdb"></a></p>
<h2 id="write-database-wdb">Write Database (WDB)</h2>
<p>The Write Database or WDB is based on w.q. This process features a
number of modifications and enhancements over w.q:</p>
<ol>
<li>
<p>Provides the option to write down to a custom partition scheme,
    defined by parted columns in sort.csv, which removes the need for
    end of day sorting;</p>
</li>
<li>
<p>Greater configuration options; max rows on a per table basis, list
     subscription tables, upd function etc. See the top of the process
     file for the options;</p>
</li>
<li>
<p>Use of common code with the RDB and Tickerplant Log Replay process
     to manipulate tables before save, sort and apply attributes;</p>
</li>
<li>
<p>Checks whether to persist data to disk on a timer rather than on
     each tick;</p>
</li>
<li>
<p>Informs other RDB, HDB and GW processes that end of day save and
     sort has completed;</p>
</li>
<li>
<p>More log information supplied;</p>
</li>
<li>
<p>End of day timezone can be configured (see <a href="../utilities/#eodtimeq">eodtime.q</a>).</p>
</li>
</ol>
<p>The WDB process can broken down into two main functions:</p>
<ol>
<li>
<p>Periodically saving data to disk and</p>
</li>
<li>
<p>Sorting data at end of day</p>
</li>
</ol>
<p>The WDB process provides flexibility so it can be set-up as a
stand-alone process that will both save and sort data or two separate
processes (one that saves the data and another that will sort the data
on disk). This allows greater flexibility around the end of day event as
sorting data can be time consuming. It is also helps when implementing
seemless rollovers (i.e. no outage window at end-of-day).</p>
<p>The behaviour of the WDB process is controlled by the <code>.wdb.mode</code>
parameter. This should be set to one of following three values:</p>
<ul>
<li>
<p>saveandsort - the process will subscribe for data, periodically
    write data to disk and at EOD it will flush remaining data to disk
    before sorting it and informing GWs, RDBs and HDBs etc.</p>
</li>
<li>
<p>save - the process will subscribe for data, periodically write data
      to disk and at EOD it will flush remaining data to disk. It will
      then inform its respective sort mode process to sort the data</p>
</li>
<li>
<p>sort - the process will wait to get a trigger from its respective
      save mode process. When this is triggered it will sort the data on
      disk, apply attributes and the trigger a reload on the RDB, HDB and
      GW processes</p>
</li>
</ul>
<p>When running a system with separate save and sort process, the sort
process should be configured in the processes.csv file with a proctype
of sort. The save process will check for processes with a proctype of
sort when it attempts to trigger the end of day sort of the data.</p>
<p>The wdb process provides two methods for persisting data to disk and
sorting at the end of the day.</p>
<ul>
<li>
<p>default - Data is persisted into a partition defined by the
    [partitiontype] variable, similar to the hdb partition scheme. The
    general scheme is of the form
    [wdbdir]/[partitiontype]/[table]/. And a typical partition
    directory would be similar to wdb/database/2015.11.26/trades/. At
    the end of the day, before being moved to the hdb, the data is
    sorted according to parameters defined in sort.csv. For each table,
    sort.csv will specify the columns to sort (using xasc) and apply
    attributes to.</p>
</li>
<li>
<p>partbyattr - Data is persisted to a custom partition scheme, derived
      from parameters in the sort.csv file. The write down scheme is taken
      from sort.csv, to reflect the effect of using xasc at the end of
      day. For each table, the columns defined in sort.csv, with the
      parted attribute, are used to create custom partitions in the wdb.
      Multiple columns can be defined with the parted attribute and
      distinct combinations of each are generated for custom partitions.
      The general partition scheme is of the form
      [wdbdir]/[partitiontype]/[table]/[parted column(s)]/. And a
      typical partition directory would be similar to
      wdb/database/2015.11.26/trade/MSFT_N. In the above example, the
      data is parted by sym and source, and so a unique partition
      directory MSFT_N is created in the wdb directory.</p>
<p>At the end of the day, data is upserted into the hdb without the
  need for sorting. The number of rows that are joined at once is
  limited by the mergenumrows and mergenumtab parameters.</p>
</li>
</ul>
<p>The optional partbyattr method may provide a significant saving in time
at the end of day, allowing the hdb to be accessed sooner. For large
data sets with a low cardinality (ie. small number of distinct elements)
the optional method may provide a significant time saving, upwards of
50%. The optional method should also reduce the memory usage at the end
of day event, as joining data is generally less memory intensive than
sorting.</p>
<p><a name="tick"></a></p>
<h2 id="tickerplant-log-replay">Tickerplant Log Replay</h2>
<p>The Tickerplant Log Replay script is for replaying tickerplant logs.
This is useful for:</p>
<ol>
<li>
<p>handling end of day save down failures;</p>
</li>
<li>
<p>handling large volumes of data (larger than can fit into RAM).</p>
</li>
</ol>
<p>The process takes as the main input either an individual log file to
replay, or a directory containing a set of log files. Amongst other
functionality, the process can:</p>
<ul>
<li>
<p>replay specific message ranges;</p>
</li>
<li>
<p>replay in manageable message chunks;</p>
</li>
<li>
<p>recover as many messages as possible from a log file rather than
      just stopping at the first bad message;</p>
</li>
<li>
<p>ignore specific tables;</p>
</li>
<li>
<p>modify the tables before or after they are saved;</p>
</li>
<li>
<p>apply sorting and parting after all the data is written out.</p>
</li>
</ul>
<p>The process must have some variables set (the tickerplant log file or
directory, the schema file, and the on-disk database directory to write
to) or it will fail on startup. These can either be set in the config
file, or overridden from the command line in the usual way. An example
start line would be:</p>
<pre><code>q torq.q -debug -load code/processes/tickerlogreplay.q -p 9990 -.replay.tplogfile ../test/tplogs/marketdata2013.12.17 -.replay.schemafile ../test/marketdata.q -.replay.hdbdir ../test/hdb1
</code></pre>
<p>The tickerplant log replay script has extended usage information which
can be accessed with -.replay.usage.</p>
<pre><code>q torq.q -debug -load code/processes/tickerlogreplay.q -p 9990 -.replay.usage
</code></pre>
<p><a name="house"></a></p>
<h2 id="housekeeping">Housekeeping</h2>
<p>The housekeeping process is used to undertake periodic system
housekeeping and maintenance, such as compressing or removing files
which are no longer required. The process will run the housekeeping jobs
periodically on a timer. Amongst other functionality the process:</p>
<ul>
<li>
<p>Allows for removing and zipping of directory files;</p>
</li>
<li>
<p>Provides an inbuilt search utility and selectively searches using a
      ‘find’ and ‘exclude’ string, and an ‘older than’ parameter;</p>
</li>
<li>
<p>Reads all tasks from a single CSV;</p>
</li>
<li>
<p>Runs on a user defined timer;</p>
</li>
<li>
<p>Can be run immediately from command line or within the process;</p>
</li>
<li>
<p>Can be easily extended to include new user defined housekeeping
      tasks.</p>
</li>
</ul>
<p>The process has two main parameters that should be set prior to use;
runtimes and inputcsv.‘Runtimes’ sets the timer to run housekeeping at
the set time(s), and ‘Inputcsv’ provides the location of the
housekeeping csv file. These can either be set in the config file, or
overridden via the command line. If these are not set, then default
parameters are used; 12.00 and ‘KDBCONFIG/housekeeping.csv’
respectively. The process is designed to run from a single csv file with
five headings:</p>
<ul>
<li>
<p>Function details the action that you wish to be carried out on the
    files, initially, this can be rm (remove) and zip (zipping);</p>
</li>
<li>
<p>Path specifies the directory that the files are in;</p>
</li>
<li>
<p>Match provides the search string to the find function, files
      returned will have names that match this string;</p>
</li>
<li>
<p>Exclude provides a second string to the find function, and these
      files are excluded from the match list;</p>
</li>
<li>
<p>Age is the ‘older than’ parameter, and the function will only be
      carried out on files older than the age given (in days).</p>
</li>
</ul>
<p>An example csv file would be:</p>
<pre><code>function,path,match,exclude,age
zip,./logs/,*.log,*tick*,2
rm,./logs/,*.log*,*tick*,4
zip,./logs/,*tick*,,1
rm,./logs/,*tick*,,3

function path      match    exclude  age
----------------------------------------
zip      "./logs/" "*.log"  "*tick*" 2
rm       "./logs/" "*.log*" "*tick*" 4
zip      "./logs/" "*tick*" ""       1
rm       "./logs/" "*tick*" ""       3
</code></pre>
<p>The process reads in the csv file, and passes it line by line to a
‘find’ function; providing a dictionary of values that can be used to
locate the files required. The find function takes advantage of system
commands to search for the files according to the specifications in the
dictionary. A search is performed for both the match string and the
exclude string, and cross referenced to produce a list of files that
match the parameters given. The files are then each passed to a further
set of system commands to perform the task of either zipping or
removing. Note that an incomplete csv or non-existant path will throw an
error.</p>
<p>The remove and zipping functions form only basic implimentations of the
housekeeping process; it is designed to be exended to include more
actions than those provided. Any user function defined in the
housekeeping code can be employed in the same fashion by providing the
name of the function,search string and age of files to the csv.</p>
<p>As well as being scheduled on a timer, the process can also be run
immediately. Adding ‘-hk.runnow 1’ to the command line when starting the
process will force immediate running of the actions in the housekeeping
csv. Likewise, setting runnow to 1b in the config file will immediately
run the cleaning process. Both methods will cause the process to exit
upon completion. Calling hkrun[] from within the q process will also
run the csv instructions immediately. This will not affect any timer
scheduling and the process will remain open upon completion.</p>
<p>Housekeeping works both on windows and unix based systems. Since the
process utilizes inbuilt system commands to perform maintenances, a
unix/windows switch detects the operating system of the host and applies
either unix or widows functions appropriately. Extensions need only be
made in the namespace of the hosting operating system (i.e. if you are
using a unix system, and wish to add a new function, you do not need to
add the function to the windows namespace to). Usage information can be
accessed using the ‘-hkusage’ flag:</p>
<pre><code>q torq.q -load code/processes/housekeeping.q -p 9999 -proctype housekeeping -procname hk1 -debug -hkusage
</code></pre>
<p><a name="file"></a></p>
<h2 id="file-alerter">File Alerter</h2>
<p>The file alerter process is a long-running process which periodically
scans a set of directories for user-specified files. If a matching file
is found it will then carry out a user-defined function on it. The files
to search for and the functions to run are read in from a csv file.
Additionally, the file alerter process can:</p>
<ul>
<li>
<p>run more than one function on the specified file.</p>
</li>
<li>
<p>optionally move the file to a new directory after running the
      function.</p>
</li>
<li>
<p>store a table of files that have already been processed.</p>
</li>
<li>
<p>run the function only on new files or run it every time the file is
      modified.</p>
</li>
<li>
<p>ignore any matching files already on the system when the process
      starts and only run a function if a new file is added or a file is
      modified.</p>
</li>
</ul>
<p>The file alerter process has four parameters which should be set prior
to use. These parameters can either be set in the config file or
overridden on the command-line. If they are not set, the default
parameters will be used. The parameters are as follows.</p>
<p><strong>inputcsv</strong> - The name and location of the csv file which defines the
behaviour of the process. The default is KDBCONFIG/filealerter.csv.</p>
<p><strong>polltime</strong> - How often the process will scan for matching files. The
default is 0D:00:01, i.e., every minute.</p>
<p><strong>alreadyprocessed</strong> - The name and location of the already-processed
table. The default is KDBCONFIG/filealerterprocessed. This table will
be created automatically the first time the process is ran.</p>
<p><strong>skipallonstart</strong> - If this is set to 1, it will ignore all files
already on the system; if it is set to 0, it will not. The default
value is 0.</p>
<p>The files to find and the functions to run are read in from a csv file
created by the user. This file has five columns, which are detailed
below.</p>
<p><strong>path</strong> - This is the path to the directory that will be scanned for
the file.</p>
<p><strong>match</strong> - This is a search string matching the name of the file to be
found. Wildcards can be used in this search, for example, “file*” will
find all files starting with “fil”.</p>
<p><strong>function</strong> - This is the name of the function to be run on the file.
This function must be defined in the script
KDBCODE/processes/filealerter.q. If the function is not defined or fails
to run, the process will throw an error and ignore that file from then
on.</p>
<p><strong>newonly</strong> - This is a boolean value. If it is set to 1, it will
only run the function on the file if it has been newly created. If it is
set to 0, then it will run the function every time the file is
modified.</p>
<p><strong>movetodirectory</strong> - This is the path of the directory you would like
to move the file to after it has been processed. If this value is left
blank, the file will not be moved.</p>
<p>It is possible to run two separate functions on the same file by adding
them as separate lines in the csv file. If the file is to be moved after
it is processed, the file alerter will run both functions on the file
and then attempt to move it. A typical csv file to configure the file
alerter would look like:</p>
<pre><code>path,match,function,newonly,movetodirectory
/path/to/dirA,fileA.*,copy,0,/path/to/newDir
/path/to/dirB,fileB.txt,email,1,
/path/to/dirA,fileA.*,delete,0,/path/to/newDir

path        match      function  newonly    movetodirectory
---------------------------------------------------
"/path/to/dirA" "fileA.*"   copy    0   "/path/to/newDir"
"/path/to/dirB" "fileB.txt" email   1   ""
"/path/to/dirA" "fileA.*"   delete  0   "/path/to/newDir"
</code></pre>
<p>The file alerter process reads in each line of the csv file and searches
files matching the search string specified in that line. Note that there
may be more than one file found if a wildcard is used in the search
string. If it finds any files, it will check that they are not in the
already processed table. If newonly is set to 1, it only checks if
the filename is already in the table. If newonly is set to 0, it
checks against the filename, filesize and a md5 hash of the file. The
md5 hash and the filesize are used to determine if the file has been
modified since it was processed last. If the found files have not been
processed already, it then attempts to run the specified function to
these files.</p>
<p>After the process has run through each line of the csv, it generates a
table of all files that were processed on that run. These files are
appended to the already processed table which is then saved to disk. The
file alerter will attempt to move the files to the ‘movetodirectory’, if
specified. If the file has already been moved during the process (for
example, if the function to run on it was ‘delete’), the file alerter
will not attempt to move it.</p>
<p>The file alerter is designed to be extended by the user. Customised
functions should be defined within the filealerter.q script. They should
be diadic functions, i.e., they take two parameters: the path and the
filename. As an example, a simple function to make a copy of a file in
another directory could be:</p>
<pre><code>copy:{[path;file] system "cp ", path,"/", file, " /path/to/newDir"}
</code></pre>
<p>Although the process is designed to run at regular intervals throughout
the day, it can be called manually by invoking the FArun[] command
from within the q session. Similarly, if new lines are added to the csv
file, then it can be re-loaded by calling the loadcsv[] command
from the q session.</p>
<p>Each stage of the process, along with any errors which may occur, are
appropriately logged in the usual manner.</p>
<p>The file alerter process is designed to work on both Windows and Unix
based systems. Since many of the functions defined will use inbuilt
system command they will be need to written to suit the operating system
in use. It should also be noted that Windows does not have an inbuilt
md5 hashing function so the file alerter will only detect different
versions of files if the filename or filesize changes.</p>
<p><a name="report"></a></p>
<h2 id="reporter">Reporter</h2>
<h3 id="overview_1">Overview</h3>
<p>The reporter process is used to run periodic reports on specific
processes. A report is the result of a query that is run on a process at
a specific time. The result of the query is then handled by one of the
inbuilt result handlers, with the ability to add custom result handlers.</p>
<p><img alt="Reporter process" src="../graphics/reporter.png" /></p>
<p>Features:</p>
<ul>
<li>
<p>Easily create a report for information that you want;</p>
</li>
<li>
<p>Fully customizable scheduling such as start time, end time and days
      of the week;</p>
</li>
<li>
<p>Run reports repeatedly with a custom period between them;</p>
</li>
<li>
<p>Asynchronous querying with custom timeout intervals;</p>
</li>
<li>
<p>Inbuilt result handlers allow reports to be written to file or
      published;</p>
</li>
<li>
<p>Custom result handlers can be defined;</p>
</li>
<li>
<p>Logs each step of the report process;</p>
</li>
<li>
<p>Fully integrated with the TorQ gateway to allow reports to be run
      across backend processes.</p>
</li>
</ul>
<p>The reporter process has three parameters that are read in on
initialisation from the reporter.q file found in the
$KDBCONFIG/settings directory. These settings are the string filepath
of the input csv file, a boolean to output log messages and timestamp
for flushing the query log table.</p>
<p>To run the reporter process:</p>
<pre><code>q torq.q -load code/processes/reporter.q -p 20004
</code></pre>
<p>Once the reporter process has been initiated, the reports will be
scheduled and no further input is required from the user.</p>
<h3 id="report-configuration">Report Configuration</h3>
<p>By default, the process takes its inputs from a file called reporter.csv
which is found in the $KDBCONFIG directory. This allows the user
complete control over the configuration of the reports. As the queries
are evaluated on the target process, local variables can be referenced
or foreign functions can be run. Table [table:reportertable] shows the
meaning of the csv schema.</p>
<table>
<thead>
<tr>
<th align="center">Column Header</th>
<th align="center">Description and Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">name</td>
<td align="center">Report name e.g. Usage</td>
</tr>
<tr>
<td align="center">query</td>
<td align="center">Query to be evaluated on that process. It can be a string query or function</td>
</tr>
<tr>
<td align="center">resulthandler</td>
<td align="center">Result handlers are run on the returned result. Custom result handlers can be added. The result handler must be a monadic function with the result data being passed in e.g. writetofile[“./output”;“usage”]</td>
</tr>
<tr>
<td align="center">gateway</td>
<td align="center">If non null the reporter will query processes route the query to the proctype specified in this field. The values in the proctype field will be the process types on which the gateway runs the backend query. e.g. `gateway</td>
</tr>
<tr>
<td align="center">joinfunction</td>
<td align="center">Used to join the results when a gateway query is being used. The choice of joinfunction must take into account the result that will be received. The function must be monadic and the parameter will be the list of results returned from the backend processes e.g. raze</td>
</tr>
<tr>
<td align="center">proctype</td>
<td align="center">The type of process that the report will be run on. If the gateway field is not empty this may be a list of process types, otherwise the reporter will throw an error on startup. e.g. `rdb</td>
</tr>
<tr>
<td align="center">procname</td>
<td align="center">The name of a specific process to run the report on. If left null, the reporter process will select a random process with the specified proctype. If the gateway field is not null, this field specifies the specific gateway process name to run the query against e.g. `hdb1</td>
</tr>
<tr>
<td align="center">start</td>
<td align="center">Time on that day to start at e.g. 12:00</td>
</tr>
<tr>
<td align="center">end</td>
<td align="center">Time on that day that the report will stop at e.g. 23:00</td>
</tr>
<tr>
<td align="center">period</td>
<td align="center">The period between each report query e.g. 00:00:10</td>
</tr>
<tr>
<td align="center">timeoutinterval</td>
<td align="center">The amount of time the reporter waits before timing out a report e.g. 00:00:30</td>
</tr>
<tr>
<td align="center">daysofweek</td>
<td align="center">Numeric value required for the day of the week. Where 0 is Saturday and 2 is Monday</td>
</tr>
</tbody>
</table>
<p>When running a report on a gateway, the gateway field must be set to the
proctype of the gateway that will be queried. It will then run the
report on the processes which are listed in the proctype field and join
the results by using the function specified in the joinfunction field.
If there is no join function then the reporter process will not start.
Multiple entries in the proctype field must be separated by a space and
are only allowed when the gateway field is not empty. If gateway field
is empty and there are multiple entries in the proctype field then the
reporter process will not load.</p>
<p>Listing [code:csvschema] shows an example of the schema needed in the
input csv file.</p>
<pre><code>name|query|resulthandler|gateway|joinfunction|proctype|procname|start|end|period|timeoutinterval|daysofweek
usage|10#.usage.usage|writetofiletype["./output/";"usage";"csv"]|||rdb||00:01|23:50|00:01|00:00:01|0 1 2 3 4 5 6
memory|.Q.w[]|writetofile["./output/";"memory.csv"]|||rdb|rdb1|00:05|18:00|00:01|00:00:08|0 1 2 3 4 5 6
usage_gateway|10#.usage.usage||gateway|raze|rdb hdb||00:02|22:00|00:01|00:00:10|0 1 2 3 4 5 6
</code></pre>
<h3 id="result-handlers">Result Handlers</h3>
<p>There are several default result handlers which are listed below. Custom
result handlers can be defined as required. The result handler will be
invoked with a single parameter (the result of the query).</p>
<p><strong>writetofiletype</strong> - Accepts 3 parameters: path, filename, filetype and
data. When writing to file it uses a date time suffix so the resultant
filename will be <code>usage_rdb_2014_01_02_15_00_12.txt</code> e.g.</p>
<pre><code>writetofiletype["./output/";"usage";"csv"]
</code></pre>
<p><strong>splaytable</strong> - This accepts 3 parameters: path, file and data. This
splays the result to a directory. The result must be a table in order to
use this function e.g.</p>
<pre><code>splaytable["./output/";"usage"]
</code></pre>
<p><strong>emailalert</strong> - This accepts 3 parameters: period, recipient list and
data. The period dictates the throttle i.e. emails will be sent at most
every period. The result of the report must be a table with a single
column called messages which contains the character list of the email
message. This is used with the monitoring checks to raise alerts, but
can be used with other functions.</p>
<pre><code>emailalert[0D00:30;("test@aquaq.co.uk";"test1@aquaq.co.uk")]
</code></pre>
<p><strong>emailreport</strong> - This accepts 3 parameters: temporary path, recipient
list, file name, file type and data. The data is written out as the file
type (e.g. csv, xml, txt, xls, json) with the given file name to the
temporary path. It is then emailed to the recipient list, and the
temporary file removed.</p>
<pre><code>emailreport["./tempdir/"; ("test@aquaq.co.uk";"test1@aquaq.co.uk"); "EndOfDayReport"; "csv"]
</code></pre>
<p><strong>publishresult</strong> - Accepts 1 parameter and that is the data. This is
discussed later in the subsection subresults.
Custom result handlers can be added to $KDBCODE/processes/reporter.q .
It is important to note that the result handler is referencing local
functions as it is executed in the reporter process and not the target
process. When the query has been successful the result handler will be
passed a dictionary with the following keys: queryid, time, name,
procname, proctype and result.</p>
<h3 id="report-process-tracking">Report Process Tracking</h3>
<p>Each step of the query is logged by the reporter process. Each query is
given a unique id and regular system messages are given the id 0. The
stage column specifies what stage the query is in and these are shown in
table [table:stagetable]. An appropriate log message is also shown so
any problems can easily be diagnosed. The in memory table is flushed
every interval depending on the value of the flushqueryloginterval
variable in the reporter.q file found in the $KDBCONFIG/settings
directory. </p>
<table>
<thead>
<tr>
<th>Stage symbol</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>R</td>
<td>The query is currently running</td>
</tr>
<tr>
<td>E</td>
<td>An error has occurred during the query</td>
</tr>
<tr>
<td>C</td>
<td>The query has been completed with no errors</td>
</tr>
<tr>
<td>T</td>
<td>The query has exceeded the timeout interval</td>
</tr>
<tr>
<td>S</td>
<td>System message e.g. “Reporter Process Initialised”</td>
</tr>
</tbody>
</table>
<pre><code>time                         | queryid stage message
-----------------------------| ------------------------------------------------------------------------
2014.10.20D22:20:06.597035000| 37 R "Received result"
2014.10.20D22:20:06.600692000| 37 R "Running resulthandler"
2014.10.20D22:20:06.604455000| 37 C "Finished report"
2014.10.20D22:30:00.984572000| 38 R "Running report: rdbtablecount against proctype: rdb on handle: 7i"
2014.10.20D22:30:00.991862000| 38 R "Received result"
2014.10.20D22:30:00.995527000| 38 R "Running resulthandler"
2014.10.20D22:30:00.999236000| 38 C "Finished report"
2014.10.20D22:30:06.784419000| 39 R "Running report: rdbtablecount against proctype: rdb on handle: 7i"
2014.10.20D22:30:06.796431000| 39 R "Received result"
</code></pre>
<h3 id="subscribing-for-results">Subscribing for Results</h3>
<p>To publish the results of the report, the reporter process uses the pub
sub functionality of TorQ. This is done by using the using the inbuilt
result handler called publishresult. In order to subscribe to this feed,
connect to the reporter process and send the function shown below over
the handle. To subscribe to all reports use a backtick as the second
parameter and to subscribe to a specific reports results include the
reporter name as a symbol.</p>
<pre><code>/- define a upd function
upd:insert

/- handle to reporter process
h: hopen 20004

/- Subscribe to all results that use the publishresult handler
h(`.ps.subscribe;`reporterprocessresults;`)

/- Subscribe to a specific report called testreport
h(`.ps.subscribe;`reporterprocessresults;`testreport)
</code></pre>
<h3 id="example-reports">Example reports</h3>
<p>The following are examples of reports that could be used in the reporter
process. The rdbtablecount report will run hourly and return the count
of all the tables in a rdb process. The memoryusage report will run
every 10 minutes against the gateway for multiple processes and will
return the <code>.Q.w[]</code> information. Both of these reports run between
9:30am to 4:00pm during the weekdays. The report onetimequery is an
example of a query that is run one time, in order to run a query once,
the period must be the same as the difference between the start and end
time.</p>
<pre><code>name|query|resulthandler|gateway|joinfunction|proctype|procname|start|end|period|timeoutinterval|daysofweek
rdbtablecount|ts!count each value each ts:tables[]|{show x`result}|||rdb|rdb1|09:30|16:00|01:00|00:00:10|2 3 4 5 6
memoryusage|.Q.w[]|writetofile["./output/";"memory.csv"]|gateway1|{enlist raze x}|rdb hdb||09:30|16:00|00:10|00:00:10|2 3 4 5 6
onetimequery|10#.usage.usage|writetofile["./output/";"onetime.csv"]|||rdb||10:00|10:01|00:01|00:00:10|2 3 4 5 6
</code></pre>
<p><a name="monitor"></a></p>
<h2 id="monitor">Monitor</h2>
<p>The Monitor process is a simple process to monitor the health of the
other processes in the system. It connects to each process that it finds
(by default using the discovery service, though can use the static file
as well) and subscribes to both heartbeats and log messages. It
maintains a keyed table of heartbeats, and a table of all log messages
received.</p>
<p>Run it with:</p>
<pre><code>aquaq $ q torq.q -load code/processes/monitor.q -p 20001
</code></pre>
<p>It is probably advisable to run the monitor process with the -trap flag,
as there may be some start up errors if the processes it is connecting
to do not have the necessary heartbeating or publish/subscribe code
loaded.</p>
<pre><code>aquaq $ q torq.q -load code/processes/monitor.q -p 20001 -trap
</code></pre>
<p>The current heartbeat statuses are tracked in .hb.hb, and the log
messages in logmsg</p>
<pre><code>q)show .hb.hb                                                                                                                                                                                                                                                                 
sym       procname    | time                          counter warning error
----------------------| ---------------------------------------------------
discovery discovery2  | 2014.01.07D13:24:31.848257000 893     0       0    
hdb       hdb1        | 2014.01.07D13:24:31.866459000 955     0       0    
rdb       rdb_europe_1| 2014.01.07D13:23:31.507203000 901     1       0    
rdb       rdb1        | 2014.01.07D13:24:31.848259000 34      0       0

q)show select from logmsg where loglevel=`ERR                                                                                                              
time                          sym  host  loglevel id      message                               
-------------------------------------------------------------------------------------
2014.01.07D12:25:17.457535000 hdb1 aquaq ERR      reload  "failed to reload database"           
2014.01.07D13:29:28.784333000 rdb1 aquaq ERR      eodsave "failed to save tables : trade, quote"
</code></pre>
<h3 id="html5-front-end">HTML5 front end</h3>
<p>A HTML5 front end has been built to display important process
information that is sent from the monitor process. It uses HTML5,
WebSockets and JavaScript on the front end and interacts with the
monitor process in the kdb+ side. The features of the front end include:</p>
<ul>
<li>
<p>Heartbeat table with processes that have warnings highlighted in
    orange and errors in red</p>
</li>
<li>
<p>Log message table displaying the last 30 errors</p>
</li>
<li>
<p>Log message error chart that is by default displayed in 5 minute
      bins</p>
</li>
<li>
<p>Chart’s bin value can be changed on the fly</p>
</li>
<li>
<p>Responsive design so works on all main devices i.e. phones, tablets
      and desktop</p>
</li>
</ul>
<p>It is accessible by going to the url <code>http://HOST:PORT/.non?monitorui</code></p>
<p><img alt="HTML5 front end" src="../graphics/monitor_ui_running.png" /></p>
<p><a name="compress"></a></p>
<h2 id="compression">Compression</h2>
<p>The compression process is a thin wrapper around the compression utility
library. It allows periodic compression of whole or parts of databases
(e.g. data is written out uncompressed and then compressed after a
certain period of time). It uses four variables defined in
KDBCONFIG/settings/compression.q which specify</p>
<ul>
<li>
<p>the compression configuration file to use</p>
</li>
<li>
<p>the database directory to compress</p>
</li>
<li>
<p>the maximum age of data to attempt to compress</p>
</li>
<li>
<p>whether the process should exit upon completion</p>
</li>
</ul>
<p>The process is run like other TorQ processes:</p>
<pre><code>q torq.q -load code/processes/compression.q -p 20005
</code></pre>
<p>Modify the settings file or override variables from the command line as
appropriate.</p>
<p><a name="kill"></a></p>
<h2 id="kill">Kill</h2>
<p>The kill process is used to connect to and terminate currently running
processes. It kills the process by sending the exit command therefore
the kill process must have appropriate permissions to send the command,
and it must be able to create a connection (i.e. it will not be able to
kill a blocked process in the same way that the unix command kill -9
would). By default, the kill process will connect to the discovery
service(s), and kill the processes of the specified types. The kill
process can be modified to not use the discovery service and instead use
the process.csv file via the configuration in the standard way.</p>
<p>If run without any command line parameters, kill.q will try to kill each
process it finds with type defined by its .servers.CONNECTIONS variable.</p>
<pre><code>q torq.q -load code/processes/kill.q -p 20000
</code></pre>
<p>.servers.CONNECTIONS can optionally be overridden from the command line
(as can any other process variable):</p>
<pre><code>q torq.q -load code/processes/kill.q -p 20000 -.servers.CONNECTIONS rdb tickerplant
</code></pre>
<p>The kill process can also be used to kill only specific named processes
within the process types:</p>
<pre><code>q torq.q -load code/processes/kill.q -p 20000 -killnames hdb1 hdb2
</code></pre>
<p><a name="chained"></a></p>
<h2 id="chained-tickerplant">Chained Tickerplant</h2>
<p>In tick+ architecture the main tickerplant is the most important
component, as it is relied upon by all the real time subscribers. When
the tickerplant goes down data will be lost, compare this to an rdb
which can be recovered after it fails. The chained tickerplant process
is an additional tickerplant that is a real time subscriber to the main
tickerplant but replicates its behaviour. It will have its own real time
subscribers and can be recovered when it fails. This is the recommended
approach when users want to perform their own custom real time analysis.</p>
<p>The chained tickerplant can:</p>
<ul>
<li>
<p>subscribe to specific tables and syms</p>
</li>
<li>
<p>batch publish at an interval or publish tick by tick</p>
</li>
<li>
<p>create a tickerplant log that its real time subscribers can replay</p>
</li>
<li>
<p>replay the source tickerplant log</p>
</li>
</ul>
<p>To launch the chained tickerplant</p>
<pre><code>q torq.q -load code/processes/chainedtp.q -p 12009
</code></pre>
<p>Chained tickerplant settings are found in <code>config/settings/chainedtp.q</code>
and are under the <code>.ctp</code> namespace.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Explanation</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>tickerplantname</td>
<td>list of tickerplant names to try and make a connection to</td>
<td><code>`tickerplant1</code></td>
</tr>
<tr>
<td>pubinterval</td>
<td>publish batch updates at this interval. If the value is 0D00:00:00 then it will publish tick by tick</td>
<td><code>0D00:00:00</code></td>
</tr>
<tr>
<td>tpconnsleep</td>
<td>number of seconds between attempts to connect to the source tickerplant</td>
<td><code>10</code></td>
</tr>
<tr>
<td>createlogfile</td>
<td>create a log file</td>
<td><code>0b</code></td>
</tr>
<tr>
<td>logdir</td>
<td>directory containing chained tickerplant logs</td>
<td><code>`:hdb</code></td>
</tr>
<tr>
<td>subscribeto</td>
<td>subscribe to these tables only (null for all)</td>
<td><code>`</code></td>
</tr>
<tr>
<td>subscribesyms</td>
<td>subscribe to these syms only (null for all)</td>
<td><code>`</code></td>
</tr>
<tr>
<td>replay</td>
<td>replay the tickerplant log file</td>
<td><code>0b</code></td>
</tr>
<tr>
<td>schema</td>
<td>retrieve schema from tickerplant</td>
<td><code>1b</code></td>
</tr>
<tr>
<td>clearlogonsubscription</td>
<td>clear log on subscription, only called if createlogfile is also enabled</td>
<td><code>0b</code></td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../conn/" title="Connection Management" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Connection Management
              </span>
            </div>
          </a>
        
        
          <a href="../visualisation/" title="Visualisation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Visualisation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy 2016 AquaQ Analytics Limited.  Kx &reg and kdb+ are registered trademarks of Kx Systems Inc.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/AquaQAnalytics" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/AquaQAnalytics" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/aquaq-analytics" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-c35428f87f.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-51911331-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>